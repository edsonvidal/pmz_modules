<?xml version="1.0"?>
<root>
  <OBJECT NAME="REGISTRO_DIARIO_CAIXAS">
    <METHOD NAME="ListaMovimentoCaixa" DESCRIPTION="Lista de Movimentos - Caixa" VERSION="66" INTFTYPE="5" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="REGISTRO_DIARIO" FORMAT="+" SIZE="8" FLAGS="1032" PROJECTION="0" ORDER="5" FIELDLABEL="Registro Diario" CTAB="0"/>
        <PARAM NAME="FILIAL" FORMAT="N" SIZE="8" FLAGS="9" STYLE="6" PROJECTION="0" ORDER="3" LOOKUP="MILLENIUM.FILIAIS.Lista_Simples" LOOKUPKEY="FILIAL" LOOKUPDISPLAY="NOME" LOOKUPCODE="COD_FILIAL" FIELDLABEL="Empresas" CTAB="0"/>
        <PARAM NAME="CAIXAS" SIZE="1000" FLAGS="9" STYLE="6" PROJECTION="0" ORDER="4" LOOKUP="MILLENIUM.CONTAS.LISTA_CAIXAS" LOOKUPKEY="CONTA" LOOKUPDISPLAY="DESCRICAO" LOOKUPCODE="NUMERO" FIELDLABEL="Caixas" CTAB="0"/>
        <PARAM NAME="DATAI" FORMAT="D" SIZE="10" FLAGS="9" DEFAULT="TODAY" PROJECTION="0" ORDER="1" FIELDLABEL="Data Inicial" CTAB="0"/>
        <PARAM NAME="DATAF" FORMAT="D" SIZE="10" FLAGS="9" DEFAULT="TODAY" PROJECTION="0" ORDER="2" FIELDLABEL="Data Final" CTAB="0"/>
        <PARAM NAME="ABERTO" FORMAT="B" SIZE="1" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="Aberto" CTAB="0"/>
        <PARAM NAME="FORCADO" FORMAT="B" SIZE="1" FLAGS="1" VISIBILITYRULE="ABERTO=FALSE" PROJECTION="0" ORDER="6" FIELDLABEL="Fechamento For&#231;ado" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="REGISTRO_DIARIO" FORMAT="+" SIZE="8" FLAGS="1034" PROJECTION="0" ORDER="16" FIELDLABEL="Registro Diario" CTAB="0"/>
        <FIELD NAME="FILIAL" FORMAT="N" SIZE="8" FLAGS="10" PROJECTION="0" ORDER="12" FIELDLABEL="Filial" CTAB="0"/>
        <FIELD NAME="CONTA" FORMAT="N" SIZE="8" FLAGS="8" PROJECTION="0" ORDER="9" FIELDLABEL="Conta" CTAB="0"/>
        <FIELD NAME="DESC_EMPRESA" SIZE="30" PROJECTION="0" ORDER="9" FIELDLABEL="Empresa" CTAB="0"/>
        <FIELD NAME="DESC_CONTA" SIZE="30" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Conta" CTAB="0"/>
        <FIELD NAME="DATA_ABERTURA" FORMAT="H" SIZE="18" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Data Abertura" CTAB="0"/>
        <FIELD NAME="DATA_FECHAMENTO" FORMAT="H" SIZE="18" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Data Fechamento" CTAB="0"/>
        <FIELD NAME="ABERTO" FORMAT="B" SIZE="1" FLAGS="9" PROJECTION="0" ORDER="11" FIELDLABEL="Aberto" CTAB="0"/>
        <FIELD NAME="FORCADO" FORMAT="B" SIZE="1" FLAGS="1" PROJECTION="0" ORDER="12" FIELDLABEL="Forcado" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT
  RG.REGISTRO_DIARIO                        AS REGISTRO_DIARIO
 ,MIN(RG.FILIAL)                            AS FILIAL
 ,MIN(RG.CONTA)                             AS CONTA
 ,MIN(F.FANTASIA)                           AS DESC_EMPRESA
 ,MIN(C.DESCRICAO)                          AS DESC_CONTA
 ,MIN(RG.DATAH_ABERTURA)                    AS DATA_ABERTURA
 ,MIN(RG.DATAH_FECHAMENTO)                  AS DATA_FECHAMENTO
 ,MIN(RG.ABERTO)                            AS ABERTO
 ,MIN(RG.FORCA)                         	AS FORCADO
FROM REGISTROS_DIARIOS RG
  INNER JOIN FILIAIS F ON F.FILIAL = RG.FILIAL
  INNER JOIN CONTAS  C ON C.CONTA = RG.CONTA
WHERE #EXTRACTDATE(RG.DATAH_ABERTURA) BETWEEN :DATAI AND :DATAF
  [AND RG.FILIAL = :FILIAL]
  [AND RG.CONTA IN #REPLACE(CAIXAS)]
  [AND RG.ABERTO = :ABERTO]
  [AND RG.FORCA = :FORCADO]
  GROUP BY RG.REGISTRO_DIARIO
;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>