<?xml version="1.0"?>
<root>
  <OBJECT NAME="FUNCIONARIOSFILIAL">
    <METHOD NAME="Incluir" DESCRIPTION="Inclusao basica dos funcionarios com cargo da Filial (vendedor,gerentes,estoquistas,sub-gerentes) - REF PMZ AGS011" VERSION="98" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="COD_FUNCIONARIO" SIZE="7" FLAGS="1" SOURCEEXPRESSION=" " PROJECTION="0" ORDER="3" FIELDLABEL="C&#243;digo" CTAB="0"/>
        <PARAM NAME="GERADORES" FORMAT="R" FLAGS="1" VISIBILITYRULE=" " STYLE="8" PROJECTION="0" ORDER="4" FIELDLABEL="Geradores" NESTEDNAME="millenium.GERADORES.GERADORES" CTAB="0"/>
        <PARAM NAME="COD_CARGO" SIZE="3" FLAGS="1" SOURCEEXPRESSION=" " PROJECTION="0" ORDER="2" FIELDLABEL="Cargo" CTAB="0"/>
        <PARAM NAME="DESATIVADO" FORMAT="B" SIZE="1" FLAGS="1" PROJECTION="0" ORDER="1" FIELDLABEL="Ativo" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="FUNCIONARIO" FORMAT="N" SIZE="8" FLAGS="1" SOURCEEXPRESSION=" " PROJECTION="0" ORDER="6" FIELDLABEL="Funcionario" CTAB="0"/>
        <FIELD NAME="GERADOR" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Gerador" CTAB="0"/>
        <FIELD NAME="TRANS_ID" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Trans Id" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>//#CHECK("SELECT COUNT(COD_FUNCIONARIO) AS N FROM FUNCIONARIOS WHERE (COD_FUNCIONARIO=:COD_FUNCIONARIO [OR CGC=:GERADORES.CGC] [OR CNPJ=:GERADORES.CNPJ] [OR RG=:GERADORES.RG] [OR CPF=:GERADORES.CPF])", N>0, const.COD_DUPL);


//Chamando um servico de inclusao do Millennium
#PRIVATE()
#call:GER millenium.geradores.incluiint(:GERADORES);

//Executando uma query para localizar o id da filial
#PRIVATE()
SELECT:CG CARGO FROM CARGOS WHERE [COD_CARGO = :COD_CARGO];

#PRIVATE()
INSERT:FUN INTO IFUNCIONARIOS(
  COD_FUNCIONARIO
 ,GERADOR
 ,CARGO
 ,NAO_MOSTRAR_NO_EVENTO
 ,INATIVO
,AFASTADO
)
VALUES (
  :COD_FUNCIONARIO
 ,:GER.GERADOR
 ,:CG.CARGO
 ,:DESATIVADO
 ,:DESATIVADO
 ,:DESATIVADO
 )
#RETURN (FUNCIONARIO);

//Retornando campos chave do resultado do processo
#PRIVATE()
SELECT FUNCIONARIO, GERADOR, TRANS_ID FROM FUNCIONARIOS WHERE FUNCIONARIO = :FUN.FUNCIONARIO;








</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>