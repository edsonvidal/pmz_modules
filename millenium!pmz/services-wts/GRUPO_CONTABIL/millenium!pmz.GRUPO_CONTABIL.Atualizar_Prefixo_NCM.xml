<?xml version="1.0"?>
<root>
  <OBJECT NAME="GRUPO_CONTABIL">
    <METHOD NAME="Atualizar_Prefixo_NCM" DESCRIPTION="Atualizar Prefixo NCM" VERSION="2" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="GRUPO_CONTABIL" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" FIELDLABEL="Grupo Contabil" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>#EACH()
SELECT:P
  P.PRODUTO,
  GC.CC_RECEITA,
  GC.CC_ESTOQUE,
  GC.CC_CUSTO,
  GC.CC_DESPESA,
  GC.CC_DEVVENDA,
  GC.CC_DEVCOMPRA,
  GC.CC_INVENTARIO,
  GC.CC_BENEFICIAMENTO,
  GC.CC_COMISSAO_DESP,
  GC.CC_RESERVA,
  GC.CC_TERCEIROS
FROM PMZ_GRUPO_CONTABIL GC
  INNER JOIN PMZ_GRUPO_CONTABIL_NCM GCF ON GCF.GRUPO_CONTABIL = GC.GRUPO_CONTABIL
  INNER JOIN CLASSIFICACAO_FIS CF ON CF.CLASSIFICACAO_FIS = GCF.CLASSIFICACAO_FIS
  INNER JOIN PRODUTOS P ON P.CLASSIFICACAO_FIS = CF.CLASSIFICACAO_FIS
WHERE GC.GRUPO_CONTABIL = GC.GRUPO_CONTABIL
  [AND GCF.GRUPO_CONTABIL = :GRUPO_CONTABIL]
  [AND P.PRODUTO = :PRODUTO]
  
#BEGIN
  UPDATE PRODUTOS
  SET
    CC_RECEITA=:P.CC_RECEITA,
    CC_ESTOQUE=:P.CC_ESTOQUE,
    CC_CUSTO=:P.CC_CUSTO,
    CC_DESPESA=:P.CC_DESPESA,
    CC_DEVVENDA=:P.CC_DEVVENDA,
    CC_DEVCOMPRA=:P.CC_DEVCOMPRA,
    CC_INVENTARIO=:P.CC_INVENTARIO,
    CC_BENEFICIAMENTO=:P.CC_BENEFICIAMENTO,
    CC_COMISSAO_DESP=:P.CC_COMISSAO_DESP,
    CC_RESERVA=:P.CC_RESERVA,
    CC_TERCEIROS=:P.CC_TERCEIROS
  WHERE PRODUTO=:P.PRODUTO;
#END;

</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>