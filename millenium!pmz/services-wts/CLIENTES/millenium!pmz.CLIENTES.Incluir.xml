<?xml version="1.0"?>
<root>
  <OBJECT NAME="CLIENTES">
    <METHOD NAME="Incluir" DESCRIPTION="Incluir novo cliente" VERSION="352" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="COD_CLIENTE" SIZE="12" FLAGS="17" SOURCEEXPRESSION="cliente.Gerador.COD_CLIENTE" PROJECTION="0" ORDER="9" FIELDLABEL="Cod Cliente" CTAB="0"/>
        <PARAM NAME="GERADORES" FORMAT="R" FLAGS="1" PROJECTION="0" ORDER="17" FIELDLABEL="Geradores" NESTEDNAME="millenium.GERADORES.GERADORES" CTAB="0"/>
        <PARAM NAME="DATA_CADASTRO" FORMAT="D" SIZE="14" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.DATA_CADASTRO" PROJECTION="0" ORDER="3" FIELDLABEL="Data Cadastro" CTAB="0"/>
        <PARAM NAME="DATA_ATUALIZACAO" FORMAT="D" SIZE="14" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.DATA_ATUALIZACAO" PROJECTION="0" ORDER="1" FIELDLABEL="Data Atualizacao" CTAB="0"/>
        <PARAM NAME="LIMITE_CREDITO" FORMAT="M" SIZE="17" FLAGS="1" DECIMALS="4" DEFAULT="0" SOURCEEXPRESSION="cliente.Gerador.LIMITE_CREDITO" PROJECTION="0" ORDER="20" FIELDLABEL="Limite Credito" CTAB="0"/>
        <PARAM NAME="CONCEITO" FORMAT="N" SIZE="8" FLAGS="1" DEFAULT="0" SOURCEEXPRESSION="cliente.Gerador.CONCEITO" PROJECTION="0" ORDER="10" FIELDLABEL="Conceito" CTAB="0"/>
        <PARAM NAME="BLOQUEIA_VENDAS" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" SOURCEEXPRESSION="cliente.Gerador.BLOQUEIA_VENDAS" PROJECTION="0" ORDER="7" FIELDLABEL="Bloqueia Vendas" CTAB="0"/>
        <PARAM NAME="BLOQUEIA_PEDIDOS" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" SOURCEEXPRESSION="cliente.Gerador.BLOQUEIA_PEDIDOS" PROJECTION="0" ORDER="6" FIELDLABEL="Bloqueia Pedidos" CTAB="0"/>
        <PARAM NAME="HISTORICO_BLOQUEIO" SIZE="200" FLAGS="1" PROJECTION="0" ORDER="19" FIELDLABEL="Historico Bloqueio" CTAB="0"/>
        <PARAM NAME="COD_FILIAL" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="16" FIELDLABEL="Filial" CTAB="0"/>
        <PARAM NAME="BANCO" FORMAT="N" SIZE="5" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="Banco" CTAB="0"/>
        <PARAM NAME="GRUPO_LOJA" FORMAT="N" SIZE="8" FLAGS="1" SOURCEEXPRESSION="cliente.grupo_loja" PROJECTION="0" ORDER="18" FIELDLABEL="Grupo Loja" CTAB="0"/>
        <PARAM NAME="CADASTRO_CREDITO" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Cadastro Credito" CTAB="0"/>
        <PARAM NAME="DADOS_ADICIONAIS" SIZE="30" FLAGS="1" PROJECTION="0" ORDER="11" FIELDLABEL="Dados Adicionais" CTAB="0"/>
        <PARAM NAME="GERADOR_C" SIZE="1" FLAGS="1" PROJECTION="0" ORDER="4" FIELDLABEL="Gerador C" CTAB="0"/>
        <PARAM NAME="PROFISSAO" FORMAT="N" SIZE="8" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.profissao" PROJECTION="0" ORDER="26" FIELDLABEL="Profissao" CTAB="0"/>
        <PARAM NAME="NATURALIDADE" SIZE="50" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.NATURALIDADE" PROJECTION="0" ORDER="21" FIELDLABEL="Naturalidade" CTAB="0"/>
        <PARAM NAME="ESTADO_CIVIL" SIZE="50" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.ESTADO_CIVIL" PROJECTION="0" ORDER="14" FIELDLABEL="Estado Civil" CTAB="0"/>
        <PARAM NAME="FILIACAO" SIZE="50" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.FILIACAO" PROJECTION="0" ORDER="15" FIELDLABEL="Filiacao" CTAB="0"/>
        <PARAM NAME="DATA_BLOQUEIO" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="2" FIELDLABEL="Data Bloqueio" CTAB="0"/>
        <PARAM NAME="OBS_FAT" FLAGS="1" PROJECTION="0" ORDER="25" FIELDLABEL="Obs Fat" CTAB="0"/>
        <PARAM NAME="OBS_CLI_FAT" FLAGS="1" PROJECTION="0" ORDER="22" FIELDLABEL="Obs Cli Fat" CTAB="0"/>
        <PARAM NAME="OBS_CLI_PREFAT" FLAGS="1" PROJECTION="0" ORDER="24" FIELDLABEL="Obs Cli Prefat" CTAB="0"/>
        <PARAM NAME="OBS_CLI_PEDIDO" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.OBS_CLI_PEDIDO" PROJECTION="0" ORDER="23" FIELDLABEL="Obs Cli Pedido" CTAB="0"/>
        <PARAM NAME="EMPRESA" SIZE="100" FLAGS="1" SOURCEEXPRESSION="cliente.Gerador.EMPRESA" PROJECTION="0" ORDER="13" FIELDLABEL="Empresa" CTAB="0"/>
        <PARAM NAME="E_MAIL_NFE" SIZE="250" FLAGS="1" PROJECTION="0" HINT="Para enviar o email para mais de um destinat&#225;rio digite os emails separados por ponto e v&#237;rgula (;).&lt;p> &#xA;&lt;B>Ex:&lt;/font>&lt;/B> &#xA;email1@seudominio.com.br;email2@seudominio.com.br" ORDER="12" FIELDLABEL="E Mail Nfe" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="CLIENTE" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="28" FIELDLABEL="Cliente" CTAB="0"/>
        <FIELD NAME="GERADOR" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="29" FIELDLABEL="Gerador" CTAB="0"/>
        <FIELD NAME="TRANS_ID" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="30" FIELDLABEL="Trans Id" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>//Valida&#231;&#245;es no Cadastro de cliente

#CHECK("SELECT COUNT (COD_CLIENTE) AS N FROM CLIENTES WHERE PF_PJ='PF' AND CPF=:GERADORES.CPF",n>0,"J&#225; existe um cliente com o mesmo CPF.");
#CHECK("SELECT COUNT (COD_CLIENTE) AS N FROM CLIENTES WHERE PF_PJ='PJ' AND CGC=:GERADORES.CGC",n>0,"J&#225; existe um cliente com o mesmo CGC/CNPJ.");
#CHECK("SELECT COUNT (COD_CLIENTE) AS N FROM CLIENTES WHERE PF_PJ='PJ' AND CNPJ=:GERADORES.CNPJ",n>0,"J&#225; existe um cliente com o mesmo CGC/CNPJ.");


//Chamando um servi&#231;o para localizar o id do banco
#PRIVATE()
#CALL:BCO MILLENIUM.BANCOS.LISTATODOS(ORDEM=1,COD_BANCO=:BANCO);

//Executando uma query para localizar o id da filial
#PRIVATE()
SELECT:FL FILIAL FROM FILIAIS WHERE COD_FILIAL = :COD_FILIAL;

//Chamando um servico de inclusao do Millennium
#PRIVATE()
#CALL:GER millenium.geradores.incluiint(:GERADORES);

//#PRIVATE()
//#CALL:GER MILLENIUM!PMZ.CLIENTES_RG.INCLUIR(:EMISSOR);

//Executando uma insercao na tabela do Millennium
#PRIVATE()
INSERT:ICLI INTO ICLIENTES(
    COD_CLIENTE
   ,GERADOR
   ,DATA_CADASTRO
   ,DATA_ATUALIZACAO
   ,LIMITE_CREDITO
   ,CONCEITO
   ,BLOQUEIA_VENDAS
   ,BLOQUEIA_PEDIDOS
   ,HISTORICO_BLOQUEIO
   ,FILIAL
   ,BANCO
   ,GRUPO_LOJA
   ,CADASTRO_CREDITO
   ,DADOS_ADICIONAIS
   ,GERADOR_C
   ,PROFISSAO
   ,NATURALIDADE
   ,ESTADO_CIVIL
   ,FILIACAO
   ,DATA_BLOQUEIO
   ,OBS_FAT
   ,OBS_CLI_FAT
   ,OBS_CLI_PREFAT
   ,OBS_CLI_PEDIDO
   ,EMPRESA
   ,E_MAIL_NFE
   ,CONTROLA_GRADE
   ,RESIDENCIA_PROPRIA
   ,INTEGRACAO_JUST_IN_TIME
   ,COD_BARRA_CLIENTE
   ,ORIGEM_CLIENTE
   ,PERMITE_ENVIAR_SMS
   ,PERMITE_ENVIAR_NEWSLETTER
   ,TRATAMENTO
)
VALUES (
    :COD_CLIENTE
   ,:GER.GERADOR
   ,:DATA_CADASTRO
   ,:DATA_ATUALIZACAO
   ,:LIMITE_CREDITO
   ,:CONCEITO
   ,:BLOQUEIA_VENDAS
   ,:BLOQUEIA_PEDIDOS
   ,:HISTORICO_BLOQUEIO
   ,:FL.FILIAL
   ,:BCO.BANCO
   ,:GRUPO_LOJA
   ,:CADASTRO_CREDITO
   ,:DADOS_ADICIONAIS
   ,:GERADOR_C
   ,:PROFISSAO
   ,:NATURALIDADE
   ,:ESTADO_CIVIL
   ,:FILIACAO
   ,:DATA_BLOQUEIO
   ,:OBS_FAT
   ,:OBS_CLI_FAT
   ,:OBS_CLI_PREFAT
   ,:OBS_CLI_PEDIDO
   ,:EMPRESA
   ,:E_MAIL_NFE
   ,FALSE
   ,FALSE
   ,FALSE
   ,FALSE
   ,'LEGADO PMZ'
   ,FALSE
   ,FALSE
   ,0
)
#RETURN(CLIENTE);

//Retornando campos chave do resultado do processo
SELECT CLIENTE, GERADOR, TRANS_ID FROM CLIENTES WHERE CLIENTE = :ICLI.CLIENTE;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>