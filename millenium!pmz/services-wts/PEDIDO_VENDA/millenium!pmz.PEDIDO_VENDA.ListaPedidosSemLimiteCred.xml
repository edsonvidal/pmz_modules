<?xml version="1.0"?>
<root>
  <OBJECT NAME="PEDIDO_VENDA">
    <METHOD NAME="ListaPedidosSemLimiteCred" DESCRIPTION="Lista Pedidos para aprova&#231;&#227;o" VERSION="28" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="DATAI" FORMAT="D" SIZE="10" FLAGS="1" DEFAULT="TODAY" PROJECTION="0" ORDER="1" FIELDLABEL="Data Inicial" CTAB="0"/>
        <PARAM NAME="DATAF" FORMAT="D" SIZE="10" FLAGS="1" DEFAULT="TODAY" PROJECTION="0" ORDER="2" FIELDLABEL="Data Final" CTAB="0"/>
        <PARAM NAME="STATUS_WORKFLOW" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="4" LOOKUP="list:'102','GERENTE';'103','DIRETOR';" FIELDLABEL="Status Workflow" CTAB="0"/>
        <PARAM NAME="FILIAL" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="3" LOOKUP="MILLENIUM.FILIAIS.LISTA_SIMPLES" LOOKUPKEY="FILIAL" LOOKUPDISPLAY="NOME" LOOKUPCODE="COD_FILIAL" FIELDLABEL="Filial" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="PEDIDO" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Pedido" CTAB="0"/>
        <FIELD NAME="COD_CLIENTE" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Cod Cliente" CTAB="0"/>
        <FIELD NAME="NOME" SIZE="255" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Nome" CTAB="0"/>
        <FIELD NAME="CNPJ_CPF" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Cnpj Cpf" CTAB="0"/>
        <FIELD NAME="STATUS" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Status" CTAB="0"/>
        <FIELD NAME="PEDIDOV" FORMAT="N" SIZE="8" PROJECTION="0" ORDER="11" FIELDLABEL="Pedidov" CTAB="0"/>
        <FIELD NAME="VALOR_PEDIDO" FORMAT="M" SIZE="17" FLAGS="1" DECIMALS="4" PROJECTION="0" FIELDLABEL="Valor Pedido" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>// Metodo que lista os pedidos que ultrapassaram o Limite de credito
SELECT
    PPV.PEDIDOV                     AS PEDIDOV,
	PPV.COD_PEDIDOV 				AS PEDIDO,
	C.COD_CLIENTE 					AS COD_CLIENTE,
	C.NOME 							AS NOME,
    #NULL_TO_S(C.CGC,C.CPF)         AS CNPJ_CPF,
    SW.DESCRICAO                    AS STATUS,
    PPV.TOTAL                       AS VALOR_PEDIDO
    FROM PEDIDO_VENDA PPV
      INNER JOIN CLIENTES C ON C.CLIENTE = PPV.CLIENTE
      INNER JOIN STATUS_WORKFLOW SW ON SW.STATUS_WORKFLOW =PPV.STATUS_WORKFLOW
      WHERE PPV.STATUS_WORKFLOW IN (103,102) AND PPV.DATA_EMISSAO BETWEEN :DATAI AND :DATAF
        AND PPV.STATUS_WORKFLOW=:STATUS_WORKFLOW AND PPV.FILIAL=:FILIAL;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>