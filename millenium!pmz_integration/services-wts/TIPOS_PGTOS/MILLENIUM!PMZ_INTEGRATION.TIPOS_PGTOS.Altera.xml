<?xml version="1.0"?>
<root>
  <OBJECT NAME="TIPOS_PGTOS">
    <METHOD NAME="Altera" DESCRIPTION="Altera Tipo de Pgto" VERSION="247" INTFTYPE="2" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
          <GROUP NAME="Acessa"/>
          <GROUP NAME="Financeiro"/>
          <GROUP NAME="Condi&#231;&#245;es de pagamentos poss&#237;veis"/>
        </GROUPS>
        <PARAM NAME="TIPO_PGTO" FORMAT="+" SIZE="8" FLAGS="1032" SOURCEEXPRESSION="tipo_pgto.TIPO_PGTO.TIPO_PGTO" PROJECTION="0" FIELDLABEL="Tipo Pgto" CTAB="0"/>
        <PARAM NAME="DESCRICAO" SIZE="30" FLAGS="17" SOURCEEXPRESSION="tipo_pgto.TIPO_PGTO.DESCRICAO" PROJECTION="0" ORDER="1" FIELDLABEL="Descri&#231;&#227;o" CTAB="0"/>
        <PARAM NAME="BAIXA_AUTO" FORMAT="B" SIZE="1" FLAGS="16" DEFAULT="0" PROJECTION="0" ORDER="5" FIELDLABEL="Baixa Auto" CTAB="0"/>
        <PARAM NAME="DESCONTO_FIN" FORMAT="N" SIZE="15" FLAGS="1" DECIMALS="7" VISIBILITYRULE="(TIPO_DESCONTO=0)" PROJECTION="0" ORDER="24" FIELDLABEL="% Desconto" GROUPNAME="Financeiro" CTAB="0"/>
        <PARAM NAME="ACESSA_NUMERO" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="18" FIELDLABEL="N&#250;mero" GROUPNAME="Acessa" CTAB="0"/>
        <PARAM NAME="ACESSA_INFBAN" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="20" FIELDLABEL="Informa&#231;&#245;es Banc&#225;rias" GROUPNAME="Acessa" CTAB="0"/>
        <PARAM NAME="ACESSA_VENCIMENTO" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="21" FIELDLABEL="Vencimento" GROUPNAME="Acessa" CTAB="0"/>
        <PARAM NAME="MOEDA" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="2" LOOKUP="MOEDAS.Lista" LOOKUPKEY="MOEDA" LOOKUPDISPLAY="DESCRICAO" FIELDLABEL="Moeda" CTAB="0"/>
        <PARAM NAME="COBRANCA" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="10" FIELDLABEL="Cobran&#231;a" CTAB="0"/>
        <PARAM NAME="TIPO_DESCONTO" FORMAT="N" SIZE="8" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="23" LOOKUP="list:'0','Percentual';'1','Express&#227;o';" FIELDLABEL="Tipo Desconto" GROUPNAME="Financeiro" CTAB="0"/>
        <PARAM NAME="NUMERO_OBR" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="19" FIELDLABEL="N&#250;mero Obrigat&#243;rio" GROUPNAME="Acessa" CTAB="0"/>
        <PARAM NAME="NATUREZA" FORMAT="N" SIZE="8" FLAGS="17" SOURCEEXPRESSION="tipo_pgto.TIPO_PGTO.NATUREZA" PROJECTION="0" ORDER="9" LOOKUP="TIPOS_PGTOS.ListarTodasNaturezas" LOOKUPKEY="CODIGO" LOOKUPDISPLAY="DESCRICAO" FIELDLABEL="Natureza" CTAB="0"/>
        <PARAM NAME="CONDICOES_PGTO" FORMAT="R" FLAGS="1" STYLE="3" PROJECTION="0" ORDER="30" FIELDLABEL="Condicoes Pgto" NESTEDNAME="millenium.TIPOS_PGTOS.CONDICOES" GROUPNAME="Condi&#231;&#245;es de pagamentos poss&#237;veis" CTAB="0"/>
        <PARAM NAME="TIPO_PAGFOR" SIZE="2" FLAGS="17" DEFAULT="31" PROJECTION="0" ORDER="5" LOOKUP="list:'01','Cr&#233;dito em Conta Corrente ou Poupan&#231;a';'02','Cheque OP (Ordem de Pagamento)';'03','DOC Compe';'05','Credito em Conta Real Time';'08','TED';'31','T&#237;tulos de Terceiros';'30','T&#237;tulos em Cobran&#231;a';'13','Pagamento de Contas de Concession&#225;rias';'91','Pagamentos de Tributos com c&#243;digo de barras';'17','GPS';'16','DARF';'18','DARF Simples';'20','Caixa &#34;Autentica&#231;&#227;o&#34;';'21','DARJ';'22','GARE-SP ICMS';'23','GARE-SP DR';'24','GARE-SP ITCMD';'25','IPVA';'26','Licenciamento SP e MG';'27','DPVAT';'35','FGTS - GRF/GRRF/GRDE';'36','OCT - Ordem de Cr&#233;dito por Teleprocessamento';" FIELDLABEL="Tipo Pagfor" CTAB="0"/>
        <PARAM NAME="CONTROLE_COBRANCA" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="11" FIELDLABEL="Grava controle de cobran&#231;a" CTAB="0"/>
        <PARAM NAME="BONUS" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="12" FIELDLABEL="Bonus" CTAB="0"/>
        <PARAM NAME="PERCENTUAL_FORMULA" FORMAT="B" SIZE="1" FLAGS="17" VISIBILITYRULE="(TIPO_DESCONTO=1)" DEFAULT="0" PROJECTION="0" ORDER="25" FIELDLABEL="Resultado da Formula em Percentual" GROUPNAME="Financeiro" CTAB="0"/>
        <PARAM NAME="AVISTA" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" HINT="Classifica se o tipo de pagamento &#233; avista ou n&#227;o. Pode ser utilizado em relat&#243;rios a serem desenvolvidos no Gerador de Relat&#243;rios." ORDER="13" FIELDLABEL="&#192; Vista" CTAB="0"/>
        <PARAM NAME="TEF" FORMAT="B" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="14" FIELDLABEL="Utiliza TEF" CTAB="0"/>
        <PARAM NAME="AUTOMATIZAR_CANCELAMENTO_CARTAO" FORMAT="B" SIZE="1" FLAGS="17" VISIBILITYRULE="(TEF=TRUE) AND ((NATUREZA=101) OR (NATUREZA=102) OR (NATUREZA=5))" DEFAULT="0" PROJECTION="0" ORDER="16" FIELDLABEL="Automatizar Cancelamento Cart&#227;o" CTAB="0"/>
        <PARAM NAME="TIPO_TAXA_FINANCEIRA" FORMAT="N" SIZE="8" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="27" LOOKUP="list:'0','Percentual';'1','Valor';" FIELDLABEL="Tipo Taxa Financeira" GROUPNAME="Financeiro" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>#CHECK("SELECT COUNT(DESCRICAO) AS N FROM TIPOS_PGTOS WHERE DESCRICAO=:DESCRICAO AND TIPO_PGTO&lt;>:TIPO_PGTO", N>0, const.COD_DUPL);
#CHECK("SELECT COUNT(*) AS N FROM DUAL WHERE #REPLACET(:DESCONTO_FIN) >= 100", N>0,'Percentual de Desconto Igual ou Superior a 100%, Verifique!');

SELECT:CDBCO COD_BANCO FROM BANCOS WHERE BANCO = :BANCO;

UPDATE TIPOS_PGTOS
   SET TIPO_PGTO=:TIPO_PGTO, DESCRICAO=:DESCRICAO, BAIXA_AUTO=:BAIXA_AUTO, DESCONTO_FIN=:DESCONTO_FIN, ACESSA_NUMERO=:ACESSA_NUMERO,
       ACESSA_INFBAN=:ACESSA_INFBAN, ACESSA_VENCIMENTO=:ACESSA_VENCIMENTO, MOEDA=:MOEDA, COBRANCA=:COBRANCA, TIPO_DESCONTO=:TIPO_DESCONTO,
       NUMERO_OBR=:NUMERO_OBR, NATUREZA=:NATUREZA, CONDICOES_PGTO=:CONDICOES_PGTO, TIPO_PAGFOR=:TIPO_PAGFOR, CONTROLE_COBRANCA=:CONTROLE_COBRANCA,
       BONUS=:BONUS, PERCENTUAL_FORMULA=:PERCENTUAL_FORMULA, AVISTA=:AVISTA, TEF=:TEF, AUTOMATIZAR_CANCELAMENTO_CARTAO=:AUTOMATIZAR_CANCELAMENTO_CARTAO,
       TIPO_TAXA_FINANCEIRA=:TIPO_TAXA_FINANCEIRA
 WHERE (TIPO_PGTO=:TIPO_PGTO);

DELETE FROM TIPOS_PGTOS_CONDICOES WHERE TIPO_PGTO =:TIPO_PGTO;

#EACH() CONDICOES_PGTO;
INSERT INTO TIPOS_PGTOS_CONDICOES ( TIPO_PGTO, CONDICOES_PGTO, VALOR_MINIMO, ALT_VENC_OPERADOR, ALT_VENC_SUPERVISOR )
VALUES( :TIPO_PGTO, :CONDICOES_PGTO.CONDICOES_PGTO, :CONDICOES_PGTO.VALOR_MINIMO, :CONDICOES_PGTO.ALT_VENC_OPERADOR, :CONDICOES_PGTO.ALT_VENC_SUPERVISOR )
#RETURN( TIPOS_PGTOS_CONDICOES );




</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>