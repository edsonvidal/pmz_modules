<?xml version="1.0"?>
<root>
  <OBJECT NAME="MOVIMENTACAO">
    <METHOD NAME="Estoque_Consultar_Saldo" DESCRIPTION="Estoque Consultar Saldo" VERSION="19" INTFTYPE="5" CATEGORY="inculada uma tabela B2B, ser&#225; retornado nos campos PRECO3 e PRECO4 os pre&#231;os &#34;POR&#34; e &#34;DE&#34; para B2B associados &#224; vitrine. Este m&#233;todo pode ser usado para atualizar os pre&#231;os regularmente j&#225; que retorna apenas as mudan&#231;as desde a &#250;ltima chamada." THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="COD_PRODUTO" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="4" FIELDLABEL="Produto" CTAB="0"/>
        <PARAM NAME="ID" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="1" FIELDLABEL="Barra Ean" CTAB="0"/>
        <PARAM NAME="LOCAL" SIZE="100" FLAGS="1" PROJECTION="0" ORDER="3" FIELDLABEL="Local" CTAB="0"/>
        <PARAM NAME="COD_FILIAL" SIZE="100" FLAGS="1" DEFAULT="003" PROJECTION="0" ORDER="2" FIELDLABEL="Filial" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="COD_PRODUTO" SIZE="30" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Cod Produto" CTAB="0"/>
        <FIELD NAME="DESCRICAO" SIZE="200" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Descri" CTAB="0"/>
        <FIELD NAME="ID" SIZE="15" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Id" CTAB="0"/>
        <FIELD NAME="EMPENHO" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Empenho" CTAB="0"/>
        <FIELD NAME="SALDO" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="13" FIELDLABEL="Saldo" CTAB="0"/>
        <FIELD NAME="FISICO" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="11" FIELDLABEL="Fisico" CTAB="0"/>
        <FIELD NAME="LOCAL" SIZE="35" FLAGS="1" PROJECTION="0" ORDER="12" FIELDLABEL="Local Estoque" CTAB="0"/>
        <FIELD NAME="COD_FILIAL" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Cod Filial" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT
   EL.PRODUTO
  ,EL.COR
  ,EL.ESTAMPA
  ,EL.TAMANHO
  ,EL.FILIAL
  ,MIN(FL.COD_FILIAL)          AS COD_FILIAL
  ,MIN(PR.COD_PRODUTO)         AS COD_PRODUTO
  ,MIN(PR.DESCRICAO1)          AS DESCRICAO
  ,MIN(CB.BARRA)               AS ID
  ,MIN(LE.LOCAL)               AS LOCAL
  ,SUM(EL.EMPENHO)             AS EMPENHO
  ,SUM(EL.SALDO)               AS SALDO
  ,SUM(EL.SALDO+EL.EMPENHO)    AS FISICO
FROM ESTOQUES_LOCAIS EL
  INNER JOIN PRODUTO_SKU SKU ON SKU.PRODUTO = EL.PRODUTO
                                 AND SKU.COR = EL.COR
                                 AND SKU.ESTAMPA = EL.ESTAMPA
                                 AND SKU.TAMANHO = EL.TAMANHO
  INNER JOIN PRODUTOS PR ON PR.PRODUTO=EL.PRODUTO
  INNER JOIN FILIAIS FL ON FL.FILIAL = EL.FILIAL
  LEFT JOIN LOCAIS_ESTOQUE LE ON LE.IDLOCAL = EL.IDLOCAL
  LEFT JOIN CODIGO_BARRAS CB ON CB.PRODUTO = EL.PRODUTO
                            AND CB.COR = EL.COR
                            AND EL.ESTAMPA = EL.ESTAMPA
                            AND CB.TAMANHO = EL.TAMANHO
                            AND CB.TIPO_BARRA = 3
WHERE EL.PRODUTO = EL.PRODUTO
  //[AND PR.COD_PRODUTO = :COD_PRODUTO]
  //[AND CB.BARRA = :ID]
  //[AND LE.LOCAL=:LOCAL]
  [AND FL.COD_FILIAL = :COD_FILIAL]
GROUP BY
   EL.PRODUTO
  ,EL.COR
  ,EL.ESTAMPA
  ,EL.TAMANHO
  ,EL.FILIAL
ORDER BY EL.FILIAL,PR.COD_PRODUTO

</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>