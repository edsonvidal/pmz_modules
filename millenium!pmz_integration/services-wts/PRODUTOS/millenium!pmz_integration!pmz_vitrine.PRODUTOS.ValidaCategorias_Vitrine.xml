<?xml version="1.0"?>
<root>
  <OBJECT NAME="PRODUTOS">
    <METHOD NAME="ValidaCategorias_Vitrine" DESCRIPTION="" VERSION="12" THREADSAFE="0">
      <PARAMS/>
      <FIELDS/>
      <ACTIONSCRIPT>SELECT:CATS_INCLUIR
DISTINCT
'LINX COMMERCE'||'\'||T.DESCRICAO||'\'||D.DESCRICAO AS CAMINHO_FILHA,
'LINX COMMERCE'||'\'||T.DESCRICAO AS CAMINHO_PAI,
D.DESCRICAO AS NOME_CLASSIFICACAO,T.DESCRICAO AS NOME_CLASSIFICACAO_1
FROM PRODUTOS P
INNER JOIN CATEGORIASP T ON T.CATEGORIA=P.CATEGORIA
INNER JOIN GRUPOS D ON D.GRUPO=P.GRUPO
LEFT JOIN  V_VITRINE_CLASSIFICACAO_TODOS V ON V.CAMINHO='LINX COMMERCE'||'\'||T.DESCRICAO||'\'||D.DESCRICAO
WHERE COALESCE(V.VITRINE_CLASSIFICACAO,0)=0;


#EACH() CATS_INCLUIR AS C
#BEGIN
//VALIDAR SE A CLASS PAI EXISTE
#CALL:PAI MILLENIUM!PMZ_INTEGRATION!PMZ_VITRINE.PRODUTOS.VALIDAPAI(CAMINHO_PAI=:C.CAMINHO_PAI,NOME=:C.NOME_CLASSIFICACAO_1);


SELECT:V_PAI VITRINE_CLASSIFICACAO FROM  V_VITRINE_CLASSIFICACAO_TODOS WHERE CAMINHO=:C.CAMINHO_PAI;

// CADASTRAR A FILHA
 #CALL:N_CLASS MILLENIUM_VITRINE.VITRINE.INCLUI_CLASSIFICACOES(PAI=:V_PAI.VITRINE_CLASSIFICACAO,VITRINE=301,DESCRICAO=:C.NOME_CLASSIFICACAO);



#END;

</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>