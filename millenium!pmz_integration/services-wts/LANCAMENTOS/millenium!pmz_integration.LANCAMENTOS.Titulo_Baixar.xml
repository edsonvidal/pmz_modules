<?xml version="1.0"?>
<root>
  <OBJECT NAME="LANCAMENTOS">
    <METHOD NAME="Titulo_Baixar" DESCRIPTION="T&#237;tulo Baixar" VERSION="36" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="N_DOCUMENTO" SIZE="35" FLAGS="17" DEFAULT="21281921111" PROJECTION="0" HINT="N&#250;mero do t&#237;tulo" ORDER="6" FIELDLABEL="Lancamento" CTAB="0"/>
        <PARAM NAME="VALOR" FORMAT="M" SIZE="17" FLAGS="1" DECIMALS="4" DEFAULT="100" PROJECTION="0" HINT="Valor do t&#237;tulo baixado" ORDER="13" FIELDLABEL="Valor Pago" CTAB="0"/>
        <PARAM NAME="DATA_PAGAMENTO" FORMAT="D" SIZE="10" FLAGS="1" DEFAULT="TODAY" PROJECTION="0" HINT="Data para pagamento do t&#237;tulo" ORDER="2" FIELDLABEL="Data Pagamento" CTAB="0"/>
        <PARAM NAME="GERA_OUTRO" FORMAT="B" SIZE="1" FLAGS="1" DEFAULT="FALSE" PROJECTION="0" HINT="Para baixa parcial informar true, se integral false" ORDER="5" FIELDLABEL="Gera Outro" CTAB="0"/>
        <PARAM NAME="OBSERVACAO" SIZE="100" FLAGS="1" DEFAULT="TESTE DE BAIXA" PROJECTION="0" HINT="Observa&#231;&#227;o para a baixa" ORDER="7" FIELDLABEL="Observacao" CTAB="0"/>
        <PARAM NAME="VALOR_DESCONTO" FORMAT="N" SIZE="17" FLAGS="1" DECIMALS="4" DEFAULT="0" PROJECTION="0" HINT="Valor de descontos" ORDER="10" FIELDLABEL="Val Desconto" CTAB="0"/>
        <PARAM NAME="VALOR_CUSTO" FORMAT="N" SIZE="17" FLAGS="1" DECIMALS="4" DEFAULT="0" PROJECTION="0" HINT="Valor de custos" ORDER="9" FIELDLABEL="Val Custo" CTAB="0"/>
        <PARAM NAME="COD_CONTA" SIZE="10" FLAGS="17" DEFAULT="13000224-8" PROJECTION="0" HINT="C&#243;digo da conta para a baixa" FIELDLABEL="Cod Conta" CTAB="0"/>
        <PARAM NAME="COD_FILIAL" SIZE="10" FLAGS="1" DEFAULT="034" PROJECTION="0" HINT="Filial do t&#237;tulo" FIELDLABEL="Cod Filial" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>//API para baixa de titulo provisionados a PAGAR ou a RECEBER(Edson Vidal/Magdiel Araujo 30/06/2021)

//Consulta a conta informada
#PRIVATE()
  SELECT:CT CONTA FROM CONTAS WHERE NUMERO=:COD_CONTA ;
    #SELECT(CT._EOF, TRUE:{#CHECK("SELECT COUNT(*) AS N FROM DUAL",N>0,"Conta n&#227;o encontrada !")},ELSE:{});
    
//Consulta o t&#237;tulo
#PRIVATE()
  SELECT:L
    L.LANCAMENTO AS LANCAMENTO
  FROM LANCAMENTOS L
    INNER JOIN FILIAIS F ON F.FILIAL = L.FILIAL
  WHERE L.N_DOCUMENTO = :N_DOCUMENTO
    AND F.COD_FILIAL = :COD_FILIAL;
  #SELECT(L._EOF, TRUE:{#CHECK("SELECT COUNT(*) AS N FROM DUAL",N>0,"Titulo n&#227;o encontrado !")},ELSE:{});
    
#CALL MILLENIUM.TITULOS.BAIXA(
   LANCAMENTO=:L.LANCAMENTO
  ,VALOR=:VALOR
  ,DATA_PAGAMENTO=:DATA_PAGAMENTO
  ,GERA_OUTRO=:GERA_OUTRO
  ,OBSERVACAO=:OBSERVACAO
  ,CONTA=:CT.CONTA
  ,VAL_CUSTO=:VALOR_CUSTO
  ,VAL_DESCONTO=:VALOR_DESCONTO
);
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>